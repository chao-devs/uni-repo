<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ã‚†ã«ã‚Œã½</title>
  <link rel="stylesheet" href="/static/style.css">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-DE4DZKZ783"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-DE4DZKZ783');
  </script>
</head>
<body>
  <h1>ã‚†ã«ã‚Œã½ | ãƒ¬ãƒãƒ¼ãƒˆæ§‹æˆAI</h1>

  <label>å­¦éƒ¨ç³»ï¼ˆå¿…é ˆï¼‰</label><br>
  <select id="faculty" class="Facu">
    <option value="" disabled selected>é¸æŠã—ã¦ãã ã•ã„</option>
    <option value="humanities">æ–‡ç³»</option>
    <option value="science">ç†ç³»</option>
    <option value="mixed">æ–‡ç†èåˆç³»</option>
  </select>
  <br><br>

  <label>èª²é¡Œæ–‡ï¼ˆå¿…é ˆï¼‰</label><br>
  <textarea id="theme" placeholder="ãƒ¬ãƒãƒ¼ãƒˆã®èª²é¡Œæ–‡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„" class="Them"></textarea>
  <br><br>

  <label>æ–‡å­—æ•°ï¼ˆå¿…é ˆï¼‰</label><br>
  <select id="length" class="Leng">
    <option value="" disabled selected>é¸æŠã—ã¦ãã ã•ã„</option>
    <option value="500">500</option>
    <option value="1000">1000</option>
    <option value="2000">2000</option>
  </select>

  <br><br>
  <button id="generateBtn" class="GBtn">æ§‹æˆã‚’ç”Ÿæˆã™ã‚‹</button>

  <hr>

  <h2 class="plan-title">æ§‹æˆæ¡ˆ</h2>

  <div class="plan-box">
    <h3>æ¡ˆ1</h3>
    <pre id="plan1">ã“ã“ã«æ¡ˆ1ãŒå…¥ã‚Šã¾ã™</pre>
  </div>

  <div class="plan-box">
    <h3>æ¡ˆ2</h3>
    <pre id="plan2">ã“ã“ã«æ¡ˆ2ãŒå…¥ã‚Šã¾ã™</pre>
  </div>

  <div class="plan-box">
    <h3>æ¡ˆ3</h3>
    <pre id="plan3">ã“ã“ã«æ¡ˆ3ãŒå…¥ã‚Šã¾ã™</pre>
  </div>

  <script>
    const generateBtn = document.getElementById("generateBtn");
    const facultySelect = document.getElementById("faculty");
    const themeInput = document.getElementById("theme");
    const lengthSelect = document.getElementById("length");

    generateBtn.addEventListener("click", async () => {
      const theme = themeInput.value.trim();
      const faculty = facultySelect.value;
      const length = Number(lengthSelect.value);

      // å…¥åŠ›ãƒã‚§ãƒƒã‚¯ï¼ˆæœ€ä½é™ï¼‰
      if (!faculty || !theme || !length) {
        alert("å­¦éƒ¨ç³»ãƒ»èª²é¡Œæ–‡ãƒ»æ–‡å­—æ•°ã‚’ã™ã¹ã¦å…¥åŠ›ã—ã¦ãã ã•ã„");
        return;
      }

      document.getElementById("plan1").innerText = "ç”Ÿæˆä¸­...";
      document.getElementById("plan2").innerText = "ç”Ÿæˆä¸­...";
      document.getElementById("plan3").innerText = "ç”Ÿæˆä¸­...";

      try {
        // ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚‚Renderã§ã‚‚åŒã˜ï¼šåŒä¸€ãƒ‰ãƒ¡ã‚¤ãƒ³ã«POSTã™ã‚‹
        const response = await fetch("/structure", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: theme, faculty, length })
        });

        if (!response.ok) {
          const txt = await response.text();
          throw new Error("HTTP " + response.status + " / " + txt);
        }

        const data = await response.json();

        document.getElementById("plan1").innerText = data.plan1 ?? "ç”Ÿæˆå¤±æ•—";
        document.getElementById("plan2").innerText = data.plan2 ?? "ç”Ÿæˆå¤±æ•—";
        document.getElementById("plan3").innerText = data.plan3 ?? "ç”Ÿæˆå¤±æ•—";

      } catch (e) {
        document.getElementById("plan1").innerText = "ã‚¨ãƒ©ãƒ¼: " + e;
        document.getElementById("plan2").innerText = "ã‚¨ãƒ©ãƒ¼";
        document.getElementById("plan3").innerText = "ã‚¨ãƒ©ãƒ¼";
      }
    });
  </script>

  <hr style="margin:24px 0; border:none; border-top:1px dashed #e5e7eb;">

  <div class="question">
    <a
      href="https://mire-ranunculus-21f.notion.site/2cc0666dae18809ca0a0fa46fc8260e8?pvs=105"
      target="_blank"
      rel="noopener noreferrer"
      style="color:#2563eb; text-decoration:underline;"
    >
      ğŸ“ æ”¹å–„ã«ã”å”åŠ›ã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼ˆ1,2åˆ†ï¼‰
    </a>
    <div class="tokumei" style="margin-top:4px; font-size:12px; color:#6b7280;">
      <p>â€»å®Œå…¨åŒ¿åãƒ»ãƒ­ã‚°ã‚¤ãƒ³ä¸è¦</p>
    </div>
  </div>
</body>
</html>
